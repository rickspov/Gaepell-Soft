# Archivo de configuración del servicio del sistema para EvaaCRM Gaepell
# Este archivo debe copiarse a /etc/systemd/system/evaa_crm_gaepell.service

[Unit]
Description=EvaaCRM Gaepell Application
Documentation=https://github.com/tu-usuario/evaa_crm_gaepell
After=network.target postgresql.service
Wants=postgresql.service
Requires=postgresql.service

# Dependencias adicionales si las necesitas
# After=redis.service
# Wants=redis.service

[Service]
Type=simple
User=oaswmjte
Group=oaswmjte
WorkingDirectory=/home2/oaswmjte/evaa_crm_gaepell

# Archivo de variables de entorno
EnvironmentFile=/home2/oaswmjte/evaa_crm_gaepell/env.sh

# Comandos de ejecución
ExecStart=/home2/oaswmjte/evaa_crm_gaepell/bin/evaa_crm_gaepell start
ExecStop=/home2/oaswmjte/evaa_crm_gaepell/bin/evaa_crm_gaepell stop
ExecReload=/home2/oaswmjte/evaa_crm_gaepell/bin/evaa_crm_gaepell restart

# Configuración de reinicio
Restart=always
RestartSec=5
StartLimitInterval=0
StartLimitBurst=5

# Configuración de logs
StandardOutput=journal
StandardError=journal
SyslogIdentifier=evaa_crm_gaepell

# Configuración de seguridad
NoNewPrivileges=true
PrivateTmp=true
ProtectSystem=strict
ProtectHome=true
ReadWritePaths=/home2/oaswmjte/evaa_crm_gaepell/priv/static/uploads
ReadWritePaths=/home2/oaswmjte/evaa_crm_gaepell/logs

# Configuración de recursos
LimitNOFILE=65536
LimitNPROC=4096

# Configuración de tiempo
TimeoutStartSec=60
TimeoutStopSec=30

# Configuración de usuario
UMask=0022

[Install]
WantedBy=multi-user.target

# Configuración adicional para logs
# StandardOutput=append:/var/log/evaa_crm_gaepell/access.log
# StandardError=append:/var/log/evaa_crm_gaepell/error.log 